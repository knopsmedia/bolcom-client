#!/usr/bin/env php
<?php

use Knops\BolcomClient\Model\DeliveryTime;
use Knops\BolcomClient\Model\ProductOffer;

require __DIR__ . '/../vendor/autoload.php';

$service = new \Knops\BolcomClient\Service\BulkImportOffersBuilder(
    __DIR__ . '/../data/template.xlsx'
);

$createEanCode = function() {
    $numbers = range(0, 9);
    $eanCode = '';

    for ($i = 0, $j = rand(8, 13); $i < $j; $i++) {
        $eanCode .= $numbers[array_rand($numbers)];
    }

    return $eanCode;
};

$pickDeliveryTime = function() {
    $times = DeliveryTime::getTimes();

    return $times[array_rand($times)];
};

for ($i = 0, $totalLines = 100; $i < $totalLines; $i++) {
    $service->add(new ProductOffer($createEanCode(), rand(1, 50), rand(1200, 5999) / 100, $pickDeliveryTime()));
}

$service->build();
